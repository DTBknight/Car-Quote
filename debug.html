<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript模块调试</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .loading { background-color: #fff3cd; color: #856404; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>JavaScript模块调试</h1>
    <div id="status"></div>
    <div id="results"></div>

    <script type="module">
        const statusDiv = document.getElementById('status');
        const resultsDiv = document.getElementById('results');
        
        function updateStatus(message, type = 'loading') {
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function logResult(title, content) {
            resultsDiv.innerHTML += `
                <h3>${title}</h3>
                <pre>${JSON.stringify(content, null, 2)}</pre>
            `;
        }
        
        async function debugModules() {
            try {
                updateStatus('开始调试JavaScript模块加载...', 'loading');
                
                // 1. 测试基础模块导入
                updateStatus('测试基础模块导入...', 'loading');
                const { Utils } = await import('./js/utils.js');
                updateStatus('✅ Utils模块加载成功', 'success');
                
                // 2. 测试配置模块
                updateStatus('测试配置模块...', 'loading');
                const CONFIG = await import('./js/config.js');
                updateStatus('✅ Config模块加载成功', 'success');
                logResult('CONFIG内容', CONFIG);
                
                // 3. 测试加载管理器
                updateStatus('测试加载管理器...', 'loading');
                const { LoadingManager } = await import('./js/loadingManager.js');
                const loadingManager = new LoadingManager();
                updateStatus('✅ LoadingManager加载成功', 'success');
                
                // 4. 测试汽车搜索模块
                updateStatus('测试汽车搜索模块...', 'loading');
                const { CarSearch } = await import('./js/carSearch.js');
                const carSearch = new CarSearch();
                updateStatus('✅ CarSearch模块加载成功', 'success');
                
                // 5. 测试数据加载
                updateStatus('测试数据加载...', 'loading');
                await carSearch.initialize();
                updateStatus('✅ 数据加载成功', 'success');
                logResult('汽车数据统计', {
                    totalCars: carSearch.allCars.length,
                    loaded: carSearch.allCarsLoaded
                });
                
                // 6. 测试主应用
                updateStatus('测试主应用...', 'loading');
                const { CarQuoteApp } = await import('./js/app.js');
                const app = CarQuoteApp.getInstance();
                updateStatus('✅ 主应用加载成功', 'success');
                
                updateStatus('🎉 所有模块加载成功！', 'success');
                
            } catch (error) {
                updateStatus(`❌ 模块加载失败: ${error.message}`, 'error');
                logResult('错误详情', {
                    message: error.message,
                    stack: error.stack,
                    time: new Date().toLocaleString()
                });
            }
        }
        
        // 页面加载完成后开始调试
        document.addEventListener('DOMContentLoaded', debugModules);
    </script>
</body>
</html> 